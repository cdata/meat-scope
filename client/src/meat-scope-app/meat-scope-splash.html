<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">
<dom-module id="meat-scope-splash">
  <template>
    <style>
      :host {
        background-color: var(--meat-scope-blue);
        @apply(--layout-fit);
        @apply(--layout-vertical);
        @apply(--layout-center-center);

        will-change: transform, opacity;
        transition: transform 0.3s, opacity 0.3s;
        transform-origin: center center;
      }

      :host([disabled]) {
        transform: scale(1.5);
        opacity: 0;
        pointer-events: none;
      }

      :host(:not(.animate)) #spinner,
      :host(:not(.animate)) #spinner:before {
        animation: none;
      }

      #spinner {
        animation: spin 1s;
        animation-iteration-count: infinite;
        animation-timing-function: linear;

        display: block;
        position: relative;
        width: 128px;
        height: 136px;
      }

      #spinner:before,
      #spinner:after {
        content: '';
        display: block;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: url('/src/images/meat_scope_sprite_sheet.svg');
        background-size: var(--meat-scope-sprite-sheet-size);
        background-repeat: no-repeat;
      }

      #spinner:after {
        background-position: -276px 4px;
      }

      #spinner:before {
        background-position: -402px 4px;

        animation: project 1s;
        animation-iteration-count: infinite;
        animation-timing-function: linear;
      }

      @keyframes project {
        0% {
          background-position: -402px 4px;
        }

        12.5% {
          background-position: -400px 3px;
        }

        25% {
          background-position: -399px 1px;
        }

        37.5% {
          background-position: -400px -1px;
        }

        50% {
          background-position: -402px -2px;
        }

        62.5% {
          background-position: -404px 1px;
        }

        75% {
          background-position: -405px 2px;
        }

        87.5% {
          background-position: -405px 3px;
        }

        100% {
          background-position: -402px 4px;
        }
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }

        100% {
          transform: rotate(360deg);
        }
      }
    </style>
    <div id="spinner">
    </div>
  </template>
  <script>
    Polymer({
      is: 'meat-scope-splash',

      properties: {
        disabled: {
          type: Boolean,
          reflectToAttribute: true,
          value: false,
          observer: '__disabledChanged'
        }
      },

      __disabledChanged: function() {
        if (this.disabled) {
          this.debounce('disabled', function() {
            this.classList.remove('animate');
          }, 500);
        } else {
          this.classList.add('animate');
        }
      }
    })
  </script>
</dom-module>
