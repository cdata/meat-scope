<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/app-route/app-location.html">
<link rel="import" href="../../bower_components/app-route/app-route.html">
<link rel="import" href="meat-scope-camera.html">
<link rel="import" href="meat-scope-videos.html">
<dom-module id="meat-scope-app">
  <template>
    <style>
      :host {
        display: block;
        position: relative;
        width: 100vw;
        height: 100vh;
        background-color: #000;
        overflow: hidden;

        --paper-fab: {
          color: var(--paper-light-blue-50);
        };

        --paper-fab-background: var(--paper-light-blue-500);
        --paper-fab-keyboard-focus-background: var(--paper-light-blue-300);
      }

      meat-scope-gallery {
        z-index: 1;
      }
    </style>
    <app-location
        route="{{route}}">
    </app-location>

    <app-route
        route="{{route}}"
        pattern="/videos"
        active="{{videosRouteActive}}">
    </app-route>

    <meat-scope-camera
        id="camera"
        disabled="[[videosRouteActive]]"
        route="{{route}}">
    </meat-scope-camera>

    <meat-scope-videos
        id="gallery"
        videos="{{videos}}"
        route="{{route}}"
        hide="[[!videosRouteActive]]"
        videos-in-progress="{{videosInProgress}}">
    </meat-scope-videos>
  </template>

  <script>
    Polymer({

      is: 'meat-scope-app',

      properties: {
        videosInProgress: {
          type: Array
        }
      },

      observers: [
        '__videosInProgressChanged(videosInProgress.length)'
      ],

      created: function() {
        this.__lastVideosInProgressLength = null;
      },

      __videosInProgressChanged: function(length) {
        if (this.__lastVideosInProgressLength != null) {
          this.fire('videos-updated');
        }

        this.__lastVideosInProgressLength = length;
      }
    });
  </script>
</dom-module>
